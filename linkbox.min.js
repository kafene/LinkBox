(function(){[].forEach.call(document.querySelectorAll("[id^=linkbox_frame_]"),function(a){a.parentNode.removeChild(a)});var a=function(){var a=(window.getSelection||document.getSelection).call(),b=[].slice.call(document.links);a.toString().trim().length>0&&(b=b.filter(function(b){return a.containsNode(b,!0)})),b=b.map(function(a){var b=(a.text||a.textContent||a.innerText).trim();return a.href?{href:a.href.trim(),title:b||a.title||a.parentNode.title||a.parentNode.alt||"",text:b,id:a.id}:null}),b=b.filter(function(a){return a&&a.href});var c=b.map(function(a){return a.href});return b=b.reverse().filter(function(a,b){return-1===c.indexOf(a.href,b+1)}).reverse()}();if(0===a.length)return window.alert("No links found."),null;var b,c,d="href",e="list",f=function(){e="list"===e?"textarea":"list",h()},g=function(){d="title"===d?"href":"title",h()},h=function(){i("textarea"===e?k():l())},i=function(a){j(),c.getElementById("container").appendChild(a)},j=function(){var a=c.getElementById("container");a&&[].forEach.call(a.querySelectorAll("*"),function(a){a.parentNode.removeChild(a)})},k=function(){var b=c.getElementById("lb_textarea");return b&&b.parentNode.removeChild(b),b=c.createElement("textarea"),b.id="lb_textarea",b.textContent="",a.forEach(function(a){b.textContent+="href"===d?a.href+"\n":"- ["+a.title+"]("+a.href+")\n"}),b},l=function(){var b=c.getElementById("linkbox_list");return b&&b.parentNode.removeChild(b),b=c.createElement("ol"),b.id="linkbox_list",a.forEach(function(a){var e=c.createElement("li"),f=c.createElement("a");f.href=a.href,f.title=a.text||a.href,f.textContent="href"===d?f.href:f.title,e.appendChild(f),b.appendChild(e)}),b},m=[["*",["box-sizing:border-box !important"]],["body,html",["height:100%","width:100%","padding:0","margin:0"]],["body",["display:flex","flex-direction:column","overflow:scroll","white-space:nowrap","color:#900","padding:1em"]],["#xbtn",["color:#fee","background-color:#cd5c5c","display:inline-block","position:absolute","top:3px","right:3px","border:1px solid #fcc","border-radius:3px","padding:0 3px","font:700 14px/100% monospace","cursor:pointer"]],["button",["font:700 13px/115% sans-serif","text-align:left","cursor:pointer"]],["ol",["font:normal 13px/115% monospace","margin-top:0"]],["textarea",["width:100%"]],["#container",["flex:1","display:flex","margin-top:0.5em"]]].map(function(a){return a[0]+" {"+a[1].join(";")+"}\n"}).join(""),n=["display:block","position:fixed","top:10px","left:10px","height:90%","width:"+Math.max(parseInt(.65*document.documentElement.clientWidth,10),600)+"px","border:3px double #000","border-radius:5px","background-color:#fff","padding:1em","margin:0","z-index:999999999","opacity:0.9","overflow-x:auto","overflow-y:auto","visibility:visible","white-space:nowrap","padding:0","margin:0"].join(" !important;")+" !important;";b=document.createElement("iframe"),b.id="linkbox_frame_"+Math.random().toString(36).substring(2),b.style.cssText=n,b.addEventListener("load",function(){c=b.contentDocument,c.addEventListener("toggleDisplayMode",g),c.addEventListener("toggleContainerType",f);var a=c.createElement("style");a.type="text/css",a.appendChild(c.createTextNode(m));var d=c.createElement("div");d.id="xbtn",d.innerHTML="&times",d.addEventListener("click",function(a){a.preventDefault(),b.parentNode.removeChild(b)});var e=c.createElement("div"),h=c.createElement("div"),j=c.createElement("div"),k=c.createElement("button"),n=c.createElement("button");j.id="container",k.textContent="Toggle display mode (title <=> href)",n.textContent="Toggle container type (list <=> textarea)",k.addEventListener("click",g),n.addEventListener("click",f),e.appendChild(k),h.appendChild(n),c.head.appendChild(a),c.body.appendChild(d),c.body.appendChild(e),c.body.appendChild(h),c.body.appendChild(j),i(l())}),(document.body||document.documentElement).appendChild(b)})();
